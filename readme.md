- æˆ‘å·²ç»ç»™tinycomputeræäº†issueï¼Œå¦‚æœä»–ä»¬èƒ½å°†micé‡å®šå‘åŠŸèƒ½æ•´åˆè¿›å»ï¼Œå°±ä¸ç”¨å•ç‹¬ç¼–è¯‘scrcpyäº†ï¼Œè¯·æ”¯æŒhttps://github.com/Cateners/tiny_computer/issues/462


è¿™æ˜¯ **CapsWriter-Offline** çš„é€‚é…åˆ†æ”¯ï¼Œä¸“é—¨é’ˆå¯¹ **å®‰å“è®¾å¤‡ä¸Šçš„ Linux å­ç³»ç»Ÿ**ä¼˜åŒ–ï¼Œè§£å†³åŸåˆ†æ”¯åœ¨å­ç³»ç»Ÿä¸­æ— æ³•ä½¿ç”¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œä¿ç•™æ‰€æœ‰ç¦»çº¿è¯­éŸ³è¾“å…¥æ ¸å¿ƒåŠŸèƒ½ã€‚
- ã€è¿™æ ·æ‰€æœ‰å®‰å“å¹³æ¿éƒ½èƒ½æ‹¥æœ‰MacBook air m1ä¸€æ ·çš„ç»­èˆªäº†ï¼Œå¯ä»¥ç”¨è¿™ä¸ªè½¯ä»¶åœ¨å®‰å“Linuxé‡Œé¢å†™å°è¯´ç¦»çº¿è¯­éŸ³ç”Ÿæˆï¼Œæ¥è‡ªäºä¸€ä¸ªä¹°ä¸èµ·MacBook airåªèƒ½ç”¨å®‰å“å¹³æ¿çš„æ‰‘è¡—ä½œè€…ï¼Œå°è¯•åœ¨å®‰å“ä¸Šç§»æ¤è¯¥è½¯ä»¶è¿›è¡Œçš„åŠªåŠ›ã€‘
- ã€æ„Ÿè°¢è±†åŒ…è¾“å…¥æ³•ï¼Œä»¥åŠè±†åŒ…ï¼Œä»¥åŠè±†åŒ…è¾“å…¥æ³•å¼€å‘ç»„ç”°å¹³å·å¤§ä½¬çš„å¸®åŠ©å’Œé¼“åŠ±ï¼Œå¦‚æœä½ æœ‰åœ¨çº¿è¯­éŸ³è¯†åˆ«çš„éœ€æ±‚ç”¨äºå†™å°è¯´ï¼Œè¯·ä½¿ç”¨è±†åŒ…è¾“å…¥æ³•ã€‘
- ã€ä¹‹åä¼šå°è¯•ç§»æ¤å…¶ä»–å‡†ç¡®ç‡æ›´é«˜çš„æ¨¡å‹ï¼Œä¾‹å¦‚GLM-ASR-Nanoï¼Œå¬è¯´æ¯”å­—èŠ‚è·³åŠ¨çš„Seed-ASRçš„å¾—åˆ†è¿˜è¦é«˜ã€‘

## ğŸ”§ ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåˆ†æ”¯ï¼Ÿ

åŸåˆ†æ”¯ä¾èµ– `keyboard` åº“å®ç°å¿«æ·é”®ç›‘å¬ï¼Œä½†å®‰å“ Linux å­ç³»ç»Ÿå­˜åœ¨ä»¥ä¸‹é™åˆ¶ï¼Œå¯¼è‡´åŸåˆ†æ”¯æ— æ³•æ­£å¸¸å·¥ä½œï¼š
- **ç»ˆç«¯è®¾å¤‡æƒé™é™åˆ¶**ï¼šå­ç³»ç»Ÿå±è”½äº†çœŸå®ç»ˆç«¯ï¼ˆTTYï¼‰å’Œé”®ç›˜è®¾å¤‡ç›´æ¥è®¿é—®ï¼Œ`keyboard` åº“è°ƒç”¨ `dumpkeys` å·¥å…·ä¼šæŠ¥é”™ï¼Œæ— æ³•ç›‘å¬å¿«æ·é”®ï¼›
- **å…¨å±€å¿«æ·é”®ä¸å…¼å®¹**ï¼š`keyboard` åº“çš„å¿«æ·é”®ç›‘å¬ä¾èµ–ç»ˆç«¯å‰å°è¿›ç¨‹ï¼›
- **éŸ³é¢‘è®¾å¤‡è½¬å‘é€‚é…**ï¼šå­ç³»ç»Ÿéœ€é€šè¿‡ `scrcpy_mic` ç­‰å·¥å…·è½¬å‘å®‰å“éº¦å…‹é£ï¼Œéœ€ç¡®ä¿éŸ³é¢‘æ ¼å¼ä¸æœåŠ¡ç«¯ä¸€è‡´ã€‚

æœ¬åˆ†æ”¯é€šè¿‡æœ€å°åŒ–ä¿®æ”¹ï¼ˆä»…æ›¿æ¢ä¾èµ–åº“ã€é€‚é…å­ç³»ç»Ÿç‰¹æ€§ï¼‰ï¼Œè§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒåŒæ—¶å®Œå…¨ä¿ç•™åŸåˆ†æ”¯çš„ç¦»çº¿è¯†åˆ«ã€çƒ­è¯ã€å‰ªè´´æ¿è¿˜åŸç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œæ¨¡æ‹Ÿäº†åŸæœ¬çš„è„šæœ¬è¡Œä¸ºã€‚

## ğŸš€ æ ¸å¿ƒä¿®æ”¹

### 1. å¿«æ·é”®ç›‘å¬ï¼š`keyboard` â†’ `pynput`
- **æ›¿æ¢åŸå› **ï¼š`pynput` æ”¯æŒå…¨å±€å¿«æ·é”®ç›‘å¬ï¼Œä¸ä¾èµ–ç»ˆç«¯è®¾å¤‡ï¼Œåå°è¿è¡Œï¼ˆå¦‚ tmux ä¼šè¯ï¼‰ä¹Ÿèƒ½å“åº”ï¼›
- **åŠŸèƒ½å¯¹é½**ï¼š
  - ä¿ç•™åŸåˆ†æ”¯çš„ã€Œé•¿æŒ‰æ¨¡å¼ã€/ã€Œå•å‡»æ¨¡å¼ã€é…ç½®ï¼›
  - å¿«æ·é”®ä» `config.py` è¯»å–ï¼ˆé»˜è®¤æ”¹ä¸º `f12`ï¼‰ï¼›
  - æ”¯æŒå‰ªè´´æ¿è¿˜åŸã€æŒ‰é”®çŠ¶æ€æ¢å¤ç­‰åŸåŠŸèƒ½ï¼›
- **ä¿®æ”¹æ–‡ä»¶**ï¼š
  - `util/client_shortcut_handler.py`ï¼ˆæ ¸å¿ƒæ›¿æ¢ï¼Œå…¨å±€å¿«æ·é”®å®ç°ï¼‰ï¼›
  - `util/client_type_result.py`ï¼ˆæ›¿æ¢æŒ‰é”®è¾“å…¥é€»è¾‘ï¼Œé€‚é…å­ç³»ç»Ÿï¼‰ã€‚

### 3. æ®‹ç•™ä¾èµ–æ¸…ç†
- ç§»é™¤æ‰€æœ‰ `keyboard` åº“æ®‹ç•™è°ƒç”¨ï¼ˆé¿å… `dumpkeys` æŠ¥é”™å¹²æ‰°äº‹ä»¶å¾ªç¯ï¼‰ï¼›
- æ›´æ–°äº†requirements.txtï¼Œç°åœ¨è¯·ç›´æ¥ç”¨è¯¥æ–‡ä»¶å®Œæˆä¾èµ–å®‰è£…ã€‚
- é€‚é…å­ç³»ç»Ÿå‰ªè´´æ¿å·¥å…·ï¼ˆæ”¯æŒ `Ctrl+V` ç²˜è´´ï¼Œé€šè¿‡å‰ªåˆ‡æ¿å…±äº«å‘é€è‡³å®‰å“å®¿ä¸»æœºï¼‰ã€‚

## ğŸ“¦ å®‰è£…ä¸ä½¿ç”¨

### å‰ææ¡ä»¶
- å®‰å“è®¾å¤‡å·²å¯ç”¨ã€ŒLinux å¼€å‘ç¯å¢ƒã€ï¼ˆå¼€å‘è€…é€‰é¡¹ä¸­å¼€å¯ï¼‰ï¼Œæˆ–å®‰è£…tinycomputerï¼Œæˆ–ä½¿ç”¨termux+tmoeå®‰è£…ï¼Œæˆ–ä½¿ç”¨å…¶ä»–ç±»ä¼¼çš„æ–¹æ³•ï¼›
- å·²é€šè¿‡ `scrcpy_mic` æˆ–å…¶ä»–å·¥å…·å®ç°å®‰å“éº¦å…‹é£è½¬å‘ï¼ˆç¡®ä¿å­ç³»ç»Ÿèƒ½è¯†åˆ«éº¦å…‹é£è®¾å¤‡ï¼‰ã€ç¨æ™šä¸€äº›æˆ‘ä¼šå‡ºä¸€ä¸ªæ•™ç¨‹ï¼Œæˆ–è€…ä½ ä»¬è‡ªå·±æ‘¸ç´¢ä¸€ä¸‹ã€‘ã€‚
- æ³¨æ„scrcpyç¼–è¯‘è„šæœ¬ä¸­ä¹Ÿéœ€è¦ä¿®æ”¹ï¼Œéœ€è¦è·³è¿‡APKçš„ç”Ÿæˆï¼Œæˆ–è€…ç¨åæˆ‘ä¸Šä¼ ä¸€ä¸ªARM64çš„é¢„ç¼–è¯‘ç‰ˆæœ¬ä»¥åŠå·²ç»å®Œæˆä¿®æ”¹çš„éƒ¨åˆ†åˆ°è¿™ä¸ªè½¯ä»¶é‡Œé¢ï¼Œå®˜æ–¹æ²¡æœ‰æä¾›ARM64çš„é¢„ç¼–è¯‘ã€‚

- å¦å¤–å‡ ä¸ªè½¯ä»¶çš„æŒ‡å—å’Œå¯¼èˆªï¼š
- scrcpy ï¼š https://github.com/Genymobile/scrcpy
- tiny_computer ï¼šhttps://github.com/Cateners/tiny_computer/releases
- ä¸‡è±¡æ‹¼éŸ³ï¼šhttps://github.com/amzxyz/rime_wanxiang



# ä¸€ã€ç¯å¢ƒå‡†å¤‡
- å®‰å“è®¾å¤‡ï¼šAndroid 11+ï¼ˆæœ¬æ¡ˆä¾‹ä¸º Android 16ï¼‰
- å®‰å“å†…ç½® Linux å­ç³»ç»Ÿï¼šarm64 æ¶æ„
- æ ¸å¿ƒä¾èµ–ï¼šgitã€gccã€mesonã€ffmpegã€pulseaudioã€openjdk-17-jdkï¼ˆscrcpy ç¼–è¯‘å¿…éœ€ï¼ŒæœåŠ¡ç«¯ä¸º Java ç¼–å†™ï¼‰

# äºŒã€ç¼–è¯‘å®‰è£… scrcpyï¼ˆé€‚é… arm64ï¼Œå« Java ä¾èµ–ï¼‰
scrcpy æœåŠ¡ç«¯åŸºäº Java å¼€å‘ï¼Œç¼–è¯‘æ—¶å¿…é¡»å®‰è£… JDKï¼Œå¦åˆ™ä¼šæŠ¥é”™ â€œæ— æ³•æ„å»º scrcpy-serverâ€ï¼Œå®Œæ•´æ­¥éª¤å¦‚ä¸‹ï¼š
```bash
# 1. å®‰è£…ç¼–è¯‘ä¾èµ–ï¼ˆå«openjdk-17-jdkï¼Œscrcpyç¼–è¯‘å¿…éœ€ï¼‰
sudo apt update && sudo apt install -y \
  git gcc make meson ninja-build \
  libusb-1.0-0-dev ffmpeg \
  libavcodec-dev libavformat-dev libavutil-dev libsdl2-dev \
  openjdk-17-jdk
# å®‰è£… FFmpeg å…¨å¥—å¼€å‘åŒ…ï¼ˆåŒ…å« libavdevice åŠå…¶å¤´æ–‡ä»¶ï¼‰
sudo apt install -y libavdevice-dev libavcodec-dev libavformat-dev libavutil-dev libswscale-dev libsdl2-dev
# 2. å…‹éš†scrcpyæºç ï¼ˆæŒ‡å®š3.3.4ç‰ˆæœ¬ï¼Œé¿å…å…¼å®¹æ€§é—®é¢˜ï¼‰
git clone -b v3.3.4 https://github.com/Genymobile/scrcpy.git
cd scrcpy
# 3. ç¼–è¯‘å¹¶å®‰è£…ï¼ˆarm64æ¶æ„è‡ªåŠ¨é€‚é…ï¼‰
meson setup build --buildtype release
ninja -C build
# ä¼šæœ‰æŠ¥é”™ï¼Œæ¥ä¸‹æ¥æˆ‘æ•™ä½ å¤„ç†ï¼Œå› ä¸ºarm64åœ¨è¯¥ç‰ˆæœ¬çš„targetæ²¡æœ‰ç›¸å…³çš„å®‰å“ç¼–è¯‘sdk
```
- å…³äºscrcpyç¼–è¯‘ï¼Œéœ€è¦åšä»¥ä¸‹ä¿®æ”¹
- å…ˆä¸‹è½½é¢„ç¼–è¯‘ç‰ˆæœ¬
```
wget -O server/scrcpy-server-v3.3.4 https://github.com/Genymobile/scrcpy/releases/download/v3.3.4/scrcpy-server-v3.3.4
```
- éšåéœ€è¦ä¿®æ”¹è„šæœ¬
```
rm -rf server/scripts/build-wrapper.sh
nano server/scripts/build-wrapper.sh
```
- ç„¶åè¦†ç›–å¡«å…¥
```
#!/usr/bin/env bash
# Wrapper script to invoke gradle from meson
set -e
# Do not execute gradle when ninja is called as root (it would download the
# whole gradle world in /root/.gradle).
# This is typically useful for calling "sudo ninja install" after a "ninja
# install"
if [[ "$EUID" == 0 ]]
then
    echo "(not invoking gradle, since we are root) - Using precompiled server" >&2
    PROJECT_ROOT="$1"
    OUTPUT="$2"
    cp "$PROJECT_ROOT/scrcpy-server-v3.3.4" "$OUTPUT"
    chmod +x "$OUTPUT"
    exit 0  # rootç”¨æˆ·æˆåŠŸè¿”å›
fi
PROJECT_ROOT="$1"
OUTPUT="$2"
BUILDTYPE="$3"
# æ³¨é‡Šæ‰Gradleç›¸å…³ä»£ç 
# GRADLE=${GRADLE:-$PROJECT_ROOT/../gradlew}
if [[ "$BUILDTYPE" == debug ]]
then
    echo "=== Using precompiled scrcpy-server (debug mode, arm64 compatible) ==="
    cp "$PROJECT_ROOT/scrcpy-server-v3.3.4" "$OUTPUT"
    chmod +x "$OUTPUT"
else
    echo "=== Using precompiled scrcpy-server (release mode, arm64 compatible) ==="
    cp "$PROJECT_ROOT/scrcpy-server-v3.3.4" "$OUTPUT"
    chmod +x "$OUTPUT"
fi
# å…³é”®æ·»åŠ ï¼šæ˜ç¡®è¿”å›æˆåŠŸçŠ¶æ€ç ï¼Œè®©ninjaç»§ç»­æ‰§è¡Œåç»­ç¼–è¯‘
exit 0
```
- éšåå®‰è£…å³å¯ï¼š
```
# ç»§ç»­ç¼–è¯‘
sudo chmod +x server/scripts/*.sh
ninja -C build
sudo ninja -C build install
# éªŒè¯å®‰è£…æˆåŠŸ
scrcpy --version  # è¾“å‡º3.3.4å³æ­£å¸¸
```
<img width="570" height="412" alt="image" src="https://github.com/user-attachments/assets/8af35711-ba77-4879-bced-be8957ec29dc" />


# ä¸‰ã€é…ç½® arm64 ç‰ˆ ADBï¼ˆè§£å†³æ¶æ„ä¸å…¼å®¹é—®é¢˜ï¼‰
- ADB ç‰ˆæœ¬å¤ªæ—§ï¼pair å‘½ä»¤æ˜¯å®‰å“ 11 + æ–°å¢çš„ï¼ˆéœ€ ADB 30.0.0+ï¼‰
- æ™®é€š Linux çš„ ADB ä¸º x86_64 æ¶æ„ï¼Œéœ€å®‰è£… arm64 ä¸“å±ç‰ˆæœ¬ï¼š
```bash
# 1. å¸è½½æ—§ç‰ˆADBï¼ˆé¿å…è·¯å¾„å†²çªï¼‰
# å¸è½½ apt å®‰è£…çš„æ—§ç‰ˆ ADB
sudo apt remove android-tools-adb -y
# 2. ä¸‹è½½å®˜æ–¹æœ€æ–°ç‰ˆ platform-toolsï¼ˆåŒ…å« arm64 ç‰ˆ ADBï¼‰
wget https://github.com/AndroidIDEOfficial/platform-tools/releases/download/v34.0.4/platform-tools-34.0.4-aarch64.tar.xz -O ~/platform-tools.tar.xz
# 3. è§£å‹åˆ°ç”¨æˆ·ç›®å½•
tar -xvf platform-tools.tar.xz
# 4. éªŒè¯ ADB ç‰ˆæœ¬ï¼ˆéœ€æ˜¾ç¤º 30.0.0+ï¼Œæ”¯æŒ pair å‘½ä»¤ï¼‰
~/platform-tools/adb --version
# å®‰è£…åˆ°ç³»ç»Ÿbin
sudo cp ~/platform-tools/{adb,fastboot,etc1tool,dmtracedump,e2fsdroid,hprof-conv,sqlite3} /usr/local/bin/
```
<img width="558" height="422" alt="image" src="https://github.com/user-attachments/assets/7a3b4c30-33dc-428b-88fe-025c7a480e94" />

# å››ã€æ— çº¿è°ƒè¯•é…å¯¹ä¸ ADB è¿æ¥ï¼ˆæœ¬åœ°ç½‘ç»œï¼Œæ— éœ€ WiFiï¼‰
é€šè¿‡å®‰å“ â€œæ— çº¿è°ƒè¯•â€ åŠŸèƒ½å®ç°å­ç³»ç»Ÿä¸å®¿ä¸»æœºçš„æœ¬åœ°è¿æ¥ï¼Œé¿å… USB ä¾èµ–ï¼š
## å®‰å“è®¾å¤‡æ“ä½œï¼š
- å¼€å¯ã€Œå¼€å‘è€…é€‰é¡¹ã€ï¼ˆè®¾ç½®â†’å…³äºæ‰‹æœºâ†’è¿ç»­ç‚¹å‡»ç‰ˆæœ¬å·ï¼‰ï¼›
- å¼€å¯ã€Œæ— çº¿è°ƒè¯•ã€ï¼Œç‚¹å‡»ã€Œé…å¯¹è®¾å¤‡ï¼ˆä½¿ç”¨é…å¯¹ç ï¼‰ã€ï¼›
- è®°å½•å¼¹å‡ºçš„ã€Œé…å¯¹åœ°å€ï¼ˆå¦‚localhost:41955ï¼‰ã€å’Œã€Œ6 ä½é…å¯¹ç ã€ã€‚

## Linux å­ç³»ç»Ÿæ“ä½œï¼š
```bash
adb kill-server && adb start-server

# 1. é…å¯¹è®¾å¤‡ï¼ˆæ›¿æ¢ä¸ºå®é™…åœ°å€å’Œé…å¯¹ç ï¼‰
adb pair localhost:41955 675984

# 2. è¿æ¥è®¾å¤‡ï¼ˆé»˜è®¤ç«¯å£5555ï¼Œä»¥è®¾å¤‡æ˜¾ç¤ºä¸ºå‡†ï¼‰
adb connect localhost:41955

# éªŒè¯è¿æ¥ï¼ˆæ˜¾ç¤ºdeviceå³æ­£å¸¸ï¼‰
adb devices
```

# äº”ã€éŸ³é¢‘è½¬æ¥é…ç½®ï¼ˆæ ¸å¿ƒï¼šè™šæ‹Ÿè®¾å¤‡ + å¼ºåˆ¶ç»‘å®šï¼‰
é€šè¿‡ Pulseaudio åˆ›å»ºè™šæ‹ŸéŸ³é¢‘è®¾å¤‡ï¼Œå°† scrcpy è½¬å‘çš„éº¦å…‹é£éŸ³é¢‘è½¬ä¸ºå­ç³»ç»Ÿå¯è¯†åˆ«çš„è¾“å…¥æºï¼š
```bash
# 1. æ¸…ç†æ—§æ¨¡å—ï¼ˆé¿å…å†²çªï¼Œé¦–æ¬¡æ‰§è¡Œå¯å¿½ç•¥æŠ¥é”™ï¼‰
pactl unload-module module-remap-source 2>/dev/null
pactl unload-module module-null-sink 2>/dev/null

# 2. åˆ›å»ºè™šæ‹Ÿsinkï¼ˆæ¥æ”¶scrcpyçš„éŸ³é¢‘è¾“å‡ºï¼‰
pactl load-module module-null-sink sink_name=scrcpy_sink  # è¾“å‡ºæ¨¡å—IDï¼ˆå¦‚18ï¼‰

# 3. åˆ›å»ºè™šæ‹Ÿsourceï¼ˆä½œä¸ºå­ç³»ç»ŸéŸ³é¢‘è¾“å…¥ï¼Œå‘½åä¸ºscrcpy_micï¼‰
pactl load-module module-remap-source source_name=scrcpy_mic master=scrcpy_sink.monitor  # è¾“å‡ºæ¨¡å—IDï¼ˆå¦‚19ï¼‰

# 4. å¯åŠ¨scrcpyå¹¶å¼ºåˆ¶éŸ³é¢‘è¾“å‡ºåˆ°è™šæ‹Ÿè®¾å¤‡ï¼ˆå…³é”®ï¼šPULSE_SINKç»‘å®šï¼‰
PULSE_SINK=scrcpy_sink scrcpy \
  --audio-source=mic \
  --no-video \
  --audio-buffer=20 \
  --audio-codec=aac \
  --serial=localhost:41955
```

# å…­ã€CapsWriter-Offline é…ç½®ä¸éŸ³é¢‘è¾“å…¥è§£å†³
```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/HaujetZhao/CapsWriter-Offline.git
cd CapsWriter-Offline

# 2. å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt --break-system-packages -i https://mirror.sjtu.edu.cn/pypi/web/simple
```

## è¿˜æœ‰å…¶ä»–ä¸€äº›å°é—®é¢˜ï¼Œç¨åæˆ‘æ•´ç†å‡ºæ¥ ##
## å¯åŠ¨å®¢æˆ·ç«¯ï¼š
```bash
sudo -E python3 core_client.py #å¿…é¡»åŠ ä¸Š-Eå‚æ•°
```
## å¯åŠ¨æœåŠ¡ç«¯ï¼š
```bash
python3 core_server.py
```


## é…ç½®å¥½äº†ä¹‹åï¼Œæ¯æ¬¡å¯åŠ¨è¿˜éœ€è¦é‡æ–°æ‰“å¼€adbï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„å¯åŠ¨è„šæœ¬##
## å¯åŠ¨éŸ³é¢‘æœåŠ¡1.shï¼š
```bash
adb kill-server && adb start-server
adb connect localhost:41955
pactl unload-module module-remap-source 2>/dev/null
pactl unload-module module-null-sink 2>/dev/null
pactl load-module module-null-sink sink_name=scrcpy_sink
pactl load-module module-remap-source source_name=scrcpy_mic master=scrcpy_sink.monitor
PULSE_SINK=scrcpy_sink scrcpy --audio-source=mic --no-video --audio-buffer=20 --serial=localhost:41955
```
## å¯åŠ¨å®¢æˆ·ç«¯2.shï¼š
```bash
sudo -E python3 core_client.py
```
## å¯åŠ¨æœåŠ¡ç«¯3.shï¼š
```bash
python3 core_server.py
```
<img width="1038" height="673" alt="image" src="https://github.com/user-attachments/assets/195d275b-a9dc-4f7d-89c7-375d223960ca" />

## - 

## æ¥ä¸‹æ¥å°±æ˜¯å®‰è£…ä¸‡è±¡æ‹¼éŸ³äº†ï¼Œä½†æ˜¯Debianè‡ªå¸¦çš„rimeç‰ˆæœ¬å¤ªä½äº†ä¸æ”¯æŒluaï¼Œflatpakä¹Ÿä¸è¡Œï¼Œéœ€è¦è‡ªå·±ç¼–è¯‘ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹æˆ‘è¸©çš„å‘ ##
- å› ä¸ºæœ¬èº«ä¹Ÿæ˜¯è™šæ‹ŸåŒ–çš„ç³»ç»Ÿï¼Œæ‰€ä»¥flatpakä¼šæŠ¥é”™
- Debian 12å®˜æ–¹æ”¯æŒçš„librimeåªåˆ°1.8.0ï¼Œè¯¥ç‰ˆæœ¬ä¸æ”¯æŒä¸‡è±¡æ‹¼éŸ³lua
- æœ€æ–°ç‰ˆçš„1.15.0çš„librimeï¼Œåœ¨bash install-plugins.sh hchunhui/librime-luahåï¼Œmake merged-pluginsä¼šæŠ¥é”™
```
###é¦–å…ˆä¸‹è½½fcitx5###
# åœæ­¢æ­£åœ¨è¿è¡Œçš„ fcitx è¿›ç¨‹
killall fcitx fcitx-dbus-watcher
# å¸è½½ fcitx ä¸»ç¨‹åºåŠæ‰€æœ‰ç»„ä»¶ï¼ˆå«ä¾èµ–ï¼‰
sudo apt remove --purge fcitx fcitx-data fcitx-bin fcitx-libs fcitx-config-common fcitx-frontend-* fcitx-modules libfcitx-*
# åˆ é™¤ç”¨æˆ·ç›®å½•ä¸‹çš„æ—§é…ç½®ï¼ˆå¯é€‰ï¼Œé¿å…å¹²æ‰°ï¼‰
rm -rf ~/.config/fcitx ~/.cache/fcitx


# å®‰è£… fcitx5 æ ¸å¿ƒåŒ…ä¸ä¸­æ–‡æ”¯æŒ
sudo apt install fcitx5 fcitx5-rime fcitx5-config-qt fcitx5-configtool fcitx5-chinese-addons fcitx5-frontend-gtk3 fcitx5-frontend-qt5 # å®‰è£…Fcitx5+Rime
im-config -s fcitx5 && fcitx5 restart  # è®¾é»˜è®¤å¹¶é‡å¯
# é…ç½®ç¯å¢ƒå˜é‡ï¼ˆLXQt éœ€å†™å…¥ ~/.xprofileï¼Œç¡®ä¿è‡ªå¯æ—¶åŠ è½½ï¼‰
echo -e "export GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=@im=fcitx" >> ~/.xprofile
# é‡å¯ fcitx5 å¹¶è®¾ç½®è‡ªå¯
fcitx5 -r &
# æ‰“å¼€é…ç½®å·¥å…·æ·»åŠ ä¸­æ–‡è¾“å…¥æ³•ï¼ˆå¦‚æ‹¼éŸ³ã€åŒæ‹¼ï¼‰
fcitx5-configtool
# æ¥ä¸‹æ¥æ£€æŸ¥é»˜è®¤ç‰ˆæœ¬çš„æ˜æœˆæ‹¼éŸ³æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœå¯ç”¨ï¼Œè¿›è¡Œæ¥ä¸‹æ¥çš„æ­¥éª¤


###æ¥ä¸‹æ¥è¿˜éœ€è¦ç¼–è¯‘librime###
sudo apt update
# å®‰è£…lua
sudo apt install -y lua5.4 liblua5.4-dev pkg-config
# å®‰è£…cmakeå’Œgcc
sudo apt install build-essential cmake
# å®‰è£…å…¶ä»–ç¼–è¯‘ä¾èµ–
sudo apt install libboost-all-dev libgoogle-glog-dev  libgtest-dev libyaml-cpp-dev libleveldb-dev libmarisa-dev  libz-dev libopencc-dev  libibus-1.0-dev libnotify-dev
# è¦æ±‚cmakeå¤§äº3.25å¦åˆ™è¦ç¼–è¯‘cmake
cmake --version
# æµ…å…‹éš† 1.14.0 ç‰ˆæœ¬ï¼ˆ--branch æ”¯æŒ tag åç§°ï¼‰
git clone --branch 1.14.0 --depth=1 https://github.com/rime/librime.git librime-1.14.0
cd librime-1.14.0
# è‡ªåŠ¨ä¸‹è½½librimeæ’ä»¶
bash install-plugins.sh hchunhui/librime-lua
# ä½¿ç”¨ä¸¤ä¸ªè¿›ç¨‹è¿›è¡Œç¼–è¯‘ï¼ˆéƒ¨åˆ†æ‰‹æœºå†…å­˜æ¯”è¾ƒå°ï¼‰
make merged-plugins -j2
# å®‰è£…
sudo make install

###æ¥ä¸‹æ¥éœ€è¦å®‰è£…ä¸‡è±¡æ‹¼éŸ³ï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®‰è£…###
# è¿™ä¸ªæ–¹æ³•å°±æœ‰å¾ˆå¤šäº†
# è·å¾—ä¸‹è½½å™¨ï¼Œæ³¨æ„ä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æœ€æ–°ç‰ˆï¼Œæˆ‘åœ¨ä½¿ç”¨çš„æ—¶å€™æ˜¯6.2.4
wget https://github.com/rimeinn/rime-wanxiang-update-tools/releases/download/v6.2.4/rime-wanxiang-update-linux
# å®‰è£…ä¸‡è±¡æ‹¼éŸ³fcitx5-rimeç‰ˆæœ¬
sudo apt install jq
bash rime-wanxiang-update-linux --inputime fcitx5 --schema base --fuzhu base --dict --gram --depdir "$HOME/.local/share/fcitx5/rime"

##æ¥ä¸‹æ¥å®‰è£…å†™å°è¯´çš„è½¯ä»¶##
# æœ€æ–°ç‰ˆéœ€è¦å…ˆç¼–è¯‘qt6-svg-pluginï¼Œæˆ‘æ²¡æœ‰æˆåŠŸï¼Œé€€è€Œæ±‚å…¶æ¬¡ç”¨æ—§ç‰ˆ
# 1. ä¸‹è½½ novelWriter 2.7.5 deb åŒ…
wget https://github.com/vkbo/novelWriter/releases/download/v2.7.5/novelwriter_2.7.5_all.deb
# 2. å®‰è£…å¹¶è‡ªåŠ¨ä¿®å¤ä¾èµ–ï¼ˆç³»ç»Ÿæºå¯æä¾› PyQt5ï¼‰
sudo dpkg -i novelwriter_2.7.5_all.deb
sudo apt -f install -y

# 3. å¯åŠ¨ novelWriter
novelwriter
```
# æ¥ä¸‹æ¥å°±å®‰è£…å¥½äº†ï¼Œä½ å¯ä»¥æ­£å¸¸ä½¿ç”¨paraformeræ¨¡å‹å’Œrimeä¸‡è±¡æ‹¼éŸ³å†™å°è¯´äº†



- 
## ä»¥ä¸‹æ˜¯å®˜æ–¹åŸæœ¬çš„æ–‡æ¡£
## CapsWriter-Offline

![image-20240108115946521](assets/image-20240108115946521.png)  

è¿™æ˜¯ `CapsWriter-Offline` ï¼Œä¸€ä¸ª PC ç«¯çš„è¯­éŸ³è¾“å…¥ã€å­—å¹•è½¬å½•å·¥å…·ã€‚

ä¸¤ä¸ªåŠŸèƒ½ï¼š

1. æŒ‰ä¸‹é”®ç›˜ä¸Šçš„ `å¤§å†™é”å®šé”®`ï¼Œå½•éŸ³å¼€å§‹ï¼Œå½“æ¾å¼€ `å¤§å†™é”å®šé”®` æ—¶ï¼Œå°±ä¼šè¯†åˆ«ä½ çš„å½•éŸ³ï¼Œå¹¶å°†è¯†åˆ«ç»“æœç«‹åˆ»è¾“å…¥
2. å°†éŸ³è§†é¢‘æ–‡ä»¶æ‹–åŠ¨åˆ°å®¢æˆ·ç«¯æ‰“å¼€ï¼Œå³å¯è½¬å½•ç”Ÿæˆ srt å­—å¹•

è§†é¢‘æ•™ç¨‹ï¼š[CapsWriter-Offline ç”µè„‘ç«¯ç¦»çº¿è¯­éŸ³è¾“å…¥å·¥å…·](https://www.bilibili.com/video/BV1tt4y1d75s/)  

## ç‰¹æ€§

1. å®Œå…¨ç¦»çº¿ã€æ— é™æ—¶é•¿ã€ä½å»¶è¿Ÿã€é«˜å‡†ç¡®ç‡ã€ä¸­è‹±æ··è¾“ã€è‡ªåŠ¨é˜¿æ‹‰ä¼¯æ•°å­—ã€è‡ªåŠ¨è°ƒæ•´ä¸­è‹±é—´éš”
2. çƒ­è¯åŠŸèƒ½ï¼šå¯ä»¥åœ¨ `hot-en.txt hot-zh.txt hot-rule.txt` ä¸­æ·»åŠ ä¸‰ç§çƒ­è¯ï¼Œå®¢æˆ·ç«¯åŠ¨æ€è½½å…¥
3. æ—¥è®°åŠŸèƒ½ï¼šé»˜è®¤æ¯æ¬¡å½•éŸ³è¯†åˆ«åï¼Œè¯†åˆ«ç»“æœè®°å½•åœ¨ `å¹´ä»½/æœˆä»½/æ—¥æœŸ.md` ï¼Œå½•éŸ³æ–‡ä»¶ä¿å­˜åœ¨ `å¹´ä»½/æœˆä»½/assets` 
4. å…³é”®è¯æ—¥è®°ï¼šè¯†åˆ«ç»“æœè‹¥ä»¥å…³é”®è¯å¼€å¤´ï¼Œä¼šè¢«è®°å½•åœ¨ `å¹´ä»½/æœˆä»½/å…³é”®è¯-æ—¥æœŸ.md`ï¼Œå…³é”®è¯åœ¨ `keywords.txt` ä¸­å®šä¹‰
5. è½¬å½•åŠŸèƒ½ï¼šå°†éŸ³è§†é¢‘æ–‡ä»¶æ‹–åŠ¨åˆ°å®¢æˆ·ç«¯æ‰“å¼€ï¼Œå³å¯è½¬å½•ç”Ÿæˆ srt å­—å¹•
6. æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯åˆ†ç¦»ï¼Œå¯ä»¥æœåŠ¡å¤šå°å®¢æˆ·ç«¯
7. ç¼–è¾‘ `config.py` ï¼Œå¯ä»¥é…ç½®æœåŠ¡ç«¯åœ°å€ã€å¿«æ·é”®ã€å½•éŸ³å¼€å…³â€¦â€¦

## æ‡’äººåŒ…

å¯¹ Windows ç«¯ï¼š

1. è¯·ç¡®ä¿ç”µè„‘ä¸Šå®‰è£…äº† [Microsoft Visual C++ Redistributable è¿è¡Œåº“](https://learn.microsoft.com/zh-cn/cpp/windows/latest-supported-vc-redist)
2. æœåŠ¡ç«¯è½½å…¥æ¨¡å‹æ‰€ç”¨çš„ onnxruntime åªèƒ½åœ¨ Windows 10 åŠä»¥ä¸Šç‰ˆæœ¬çš„ç³»ç»Ÿä½¿ç”¨
3. æœåŠ¡ç«¯è½½å…¥æ¨¡å‹éœ€è¦ç³»ç»Ÿå†…å­˜ 4Gï¼Œåªèƒ½åœ¨ 64 ä½ç³»ç»Ÿä¸Šä½¿ç”¨
4. é¢å¤–æ‰“åŒ…äº† 32 ä½ç³»ç»Ÿå¯ç”¨çš„å®¢æˆ·ç«¯ï¼Œåœ¨ Windows 7 åŠä»¥ä¸Šç‰ˆæœ¬çš„ç³»ç»Ÿå¯ç”¨
5. æ¨¡å‹æ–‡ä»¶è¾ƒå¤§ï¼Œå•ç‹¬æ‰“åŒ…ï¼Œè§£å‹æ¨¡å‹åè¯·æ”¾å…¥è½¯ä»¶ç›®å½•çš„ `models` æ–‡ä»¶å¤¹ä¸­

å…¶å®ƒç³»ç»Ÿï¼š

1. å…¶å®ƒç³»ç»Ÿï¼Œå¯ä»¥ä¸‹è½½æ¨¡å‹ã€å®‰è£…ä¾èµ–åä» Python æºç è¿è¡Œã€‚
2. ç”±äºæˆ‘æ²¡æœ‰ Mac ç”µè„‘ï¼Œæ— æ³•æ‰“åŒ… Mac ç‰ˆæœ¬ï¼Œåªèƒ½ä»æºç è¿è¡Œï¼Œå¯èƒ½ä¼šæœ‰è¯¸å¤šé—®é¢˜è¦è§£å†³ã€‚ï¼ˆç”±äºç³»ç»Ÿé™åˆ¶ï¼Œå®¢æˆ·ç«¯éœ€è¦ sudo å¯åŠ¨ï¼Œä¸”é»˜è®¤å¿«æ·é”®ä¸º `right shift`ï¼‰

æ¨¡å‹è¯´æ˜ï¼š

1. ç”±äºæ¨¡å‹æ–‡ä»¶å¤ªå¤§ï¼Œä¸ºäº†æ–¹ä¾¿æ›´æ–°ï¼Œå•ç‹¬æ‰“åŒ…
2. è§£å‹æ¨¡å‹åè¯·æ”¾å…¥è½¯ä»¶ç›®å½•çš„ `models` æ–‡ä»¶å¤¹ä¸­

ä¸‹è½½åœ°å€ï¼š

- ç™¾åº¦ç›˜: https://pan.baidu.com/s/1zNHstoWZDJVynCBz2yS9vg æå–ç : eu4c 
- GitHub Release: [Releases Â· HaujetZhao/CapsWriter-Offline](https://github.com/HaujetZhao/CapsWriter-Offline/releases) 

ï¼ˆç™¾åº¦ç½‘ç›˜å®¹æ˜“æ‰é“¾æ¥ï¼Œè¡¥é“¾æ¥å¤ªéº»çƒ¦äº†ï¼Œæˆ‘ä¸ä¸€å®šä¼šè¡¥é“¾æ¥ã€‚GitHub Releases ç•Œé¢ä¸‹è½½æ˜¯æœ€å¯é çš„ã€‚ï¼‰

![image-20240108114351535](assets/image-20240108114351535.png) 



## åŠŸèƒ½ï¼šçƒ­è¯

å¦‚æœä½ æœ‰ä¸“ç”¨åè¯éœ€è¦æ›¿æ¢ï¼Œå¯ä»¥åŠ å…¥çƒ­è¯æ–‡ä»¶ã€‚è§„åˆ™æ–‡ä»¶ä¸­ä»¥ `#` å¼€å¤´çš„è¡Œä»¥åŠç©ºè¡Œä¼šè¢«å¿½ç•¥ï¼Œå¯ä»¥ç”¨ä½œæ³¨é‡Šã€‚

- ä¸­æ–‡çƒ­è¯è¯·å†™åˆ° `hot-zh.txt` æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œæ›¿æ¢ä¾æ®ä¸ºæ‹¼éŸ³ï¼Œå®æµ‹æ¯ 1 ä¸‡æ¡çƒ­è¯çº¦å¼•å…¥ 3ms å»¶è¿Ÿ

- è‹±æ–‡çƒ­è¯è¯·å†™åˆ° `hot-en.txt` æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œæ›¿æ¢ä¾æ®ä¸ºå­—æ¯æ‹¼å†™

- è‡ªå®šä¹‰è§„åˆ™çƒ­è¯è¯·å†™åˆ° `hot-rule.txt` æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œå°†æœç´¢å’Œæ›¿æ¢è¯ä»¥ç­‰å·éš”å¼€ï¼Œå¦‚ `æ¯«å®‰æ—¶  =  mAh` 

ä½ å¯ä»¥åœ¨ `core_client.py` æ–‡ä»¶ä¸­é…ç½®æ˜¯å¦åŒ¹é…ä¸­æ–‡å¤šéŸ³å­—ï¼Œæ˜¯å¦ä¸¥æ ¼åŒ¹é…æ‹¼éŸ³å£°è°ƒã€‚

æ£€æµ‹åˆ°ä¿®æ”¹åï¼Œå®¢æˆ·ç«¯ä¼šåŠ¨æ€è½½å…¥çƒ­è¯ï¼Œæ•ˆæœç¤ºä¾‹ï¼š

1. ä¾‹å¦‚ `hot-zh.txt` æœ‰çƒ­è¯ã€Œæˆ‘å®¶é¸½é¸½ã€ï¼Œåˆ™æ‰€æœ‰è¯†åˆ«ç»“æœä¸­çš„ã€Œæˆ‘å®¶å“¥å“¥ã€éƒ½ä¼šè¢«æ›¿æ¢æˆã€Œæˆ‘å®¶é¸½é¸½ã€
2. ä¾‹å¦‚ `hot-en.txt` æœ‰çƒ­è¯ã€ŒChatGPTã€ï¼Œåˆ™æ‰€æœ‰è¯†åˆ«ç»“æœä¸­çš„ã€Œchat gptã€éƒ½ä¼šè¢«æ›¿æ¢æˆã€ŒChatGPTã€
3. ä¾‹å¦‚ `hot-rule.txt` æœ‰çƒ­è¯ã€Œæ¯«å®‰æ—¶ = mAhã€ï¼Œåˆ™æ‰€æœ‰è¯†åˆ«ç»“æœä¸­çš„ã€Œæ¯«å®‰æ—¶ã€éƒ½ä¼šè¢«æ›¿æ¢æˆã€ŒmAhã€

![image-20230531221314983](assets/image-20230531221314983.png)



## åŠŸèƒ½ï¼šæ—¥è®°ã€å…³é”®è¯

é»˜è®¤æ¯æ¬¡è¯­éŸ³è¯†åˆ«ç»“æŸåï¼Œä¼šä»¥å¹´ã€æœˆä¸ºåˆ†ç±»ï¼Œä¿å­˜å½•éŸ³æ–‡ä»¶å’Œè¯†åˆ«ç»“æœï¼š

- å½•éŸ³æ–‡ä»¶å­˜æ”¾åœ¨ã€Œå¹´/æœˆ/assetsã€æ–‡ä»¶å¤¹ä¸‹
- è¯†åˆ«ç»“æœå­˜æ”¾åœ¨ã€Œå¹´/æœˆ/æ—¥.mdã€Markdown æ–‡ä»¶ä¸­

ä¾‹å¦‚ä»Šå¤©æ˜¯2023å¹´6æœˆ5å·ï¼Œç¤ºä¾‹ï¼š

1. è¯­éŸ³è¾“å…¥ä»»ä¸€å¥è¯åï¼Œå½•éŸ³å°±ä¼šè¢«ä¿å­˜åˆ° `2023/06/assets` è·¯å¾„ä¸‹ï¼Œä»¥æ—¶é—´å’Œè¯†åˆ«ç»“æœå‘½åï¼Œå¹¶å°†è¯†åˆ«ç»“æœä¿å­˜åˆ° `2023/06/05.md` æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿æˆ‘æ—¥åæŸ¥é˜…
2. ä¾‹å¦‚æˆ‘åœ¨ `keywords.txt` ä¸­å®šä¹‰äº†å…³é”®è¯ã€Œå¥åº·ã€ï¼Œç”¨äºéšæ—¶è®°å½•è‡ªå·±çš„èº«ä½“çŠ¶å†µï¼Œåƒå®Œé¥­åæˆ‘å¯ä»¥æŒ‰ä½ `CapsLock` è¯´ã€Œå¥åº·ä»Šå¤©ä¸­åˆåƒäº†å¤§ç±³ç‚’é¥­ã€ï¼Œç”±äºè¯†åˆ«ç»“æœä»¥ã€Œå¥åº·ã€å…³é”®è¯å¼€å¤´ï¼Œè¿™æ¡è¯†åˆ«è®°å½•å°±ä¼šè¢«ä¿å­˜åˆ° `2023/06/05-å¥åº·.md` ä¸­
3. ä¾‹å¦‚æˆ‘åœ¨ `keywords.txt` ä¸­å®šä¹‰äº†å…³é”®è¯ã€Œé‡è¦ã€ï¼Œç”¨äºéšæ—¶è®°å½•çªç„¶çš„çµæ„Ÿï¼Œæœ‰æƒ³æ³•æ—¶æˆ‘å°±å¯ä»¥æŒ‰ä½ `CapsLock` è¯´ã€Œé‡è¦ï¼Œxxé—®é¢˜å¯ä»¥ç”¨xxxxæ–¹æ³•è§£å†³ã€ï¼Œç”±äºè¯†åˆ«ç»“æœä»¥ã€Œé‡è¦ã€å…³é”®è¯å¼€å¤´ï¼Œè¿™æ¡è¯†åˆ«è®°å½•å°±ä¼šè¢«ä¿å­˜åˆ° `2023/06/05-é‡è¦.md` ä¸­

![image-20230604144824341](assets/image-20230604144824341.png)  

## åŠŸèƒ½ï¼šè½¬å½•æ–‡ä»¶

åœ¨æœåŠ¡ç«¯è¿è¡Œåï¼Œå°†éŸ³è§†é¢‘æ–‡ä»¶æ‹–åŠ¨åˆ°å®¢æˆ·ç«¯æ‰“å¼€ï¼Œå³å¯è½¬å½•ç”Ÿæˆå››ä¸ªåŒåæ–‡ä»¶ï¼š

- `json` æ–‡ä»¶ï¼ŒåŒ…å«äº†å­—çº§æ—¶é—´æˆ³
- `txt` æ–‡ä»¶ï¼ŒåŒ…å«äº†åˆ†è¡Œç»“æœ
- `merge.txt` æ–‡ä»¶ï¼ŒåŒ…å«äº†å¸¦æ ‡ç‚¹çš„æ•´æ®µç»“æœ
- `srt` æ–‡ä»¶ï¼Œå­—å¹•æ–‡ä»¶

å¦‚æœç”Ÿæˆçš„å­—å¹•æœ‰å¾®å°é”™è¯¯ï¼Œå¯ä»¥åœ¨åˆ†è¡Œçš„ `txt` æ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œç„¶åå°† `txt` æ–‡ä»¶æ‹–åŠ¨åˆ°å®¢æˆ·ç«¯æ‰“å¼€ï¼Œå®¢æˆ·ç«¯æ£€æµ‹åˆ°è¾“å…¥çš„æ˜¯ `txt` æ–‡ä»¶ï¼Œå°±ä¼šæŸ¥åˆ°åŒåçš„ `json`  æ–‡ä»¶ï¼Œç»“åˆ `json` æ–‡ä»¶ä¸­çš„å­—çº§æ—¶é—´æˆ³å’Œ `txt` æ–‡ä»¶ä¸­ä¿®æ­£ç»“æœï¼Œæ›´æ–° `srt` å­—å¹•æ–‡ä»¶ã€‚

## æ³¨æ„äº‹é¡¹

1. å½“ç”¨æˆ·å®‰è£…äº† `FFmpeg` æ—¶ï¼Œä¼šä»¥ `mp3` æ ¼å¼ä¿å­˜å½•éŸ³ï¼›å½“ç”¨æˆ·æ²¡æœ‰è£… `FFmpeg` æ—¶ï¼Œä¼šä»¥ `wav` æ ¼å¼ä¿å­˜å½•éŸ³
2. éŸ³è§†é¢‘æ–‡ä»¶è½¬å½•åŠŸèƒ½ä¾èµ–äº `FFmpeg`ï¼Œæ‰“åŒ…ç‰ˆæœ¬å·²å†…ç½® `FFmpeg` 
3. é»˜è®¤çš„å¿«æ·é”®æ˜¯ `caps lock`ï¼Œä½ å¯ä»¥æ‰“å¼€ `core_client.py` è¿›è¡Œä¿®æ”¹
4. MacOS æ— æ³•ç›‘æµ‹åˆ° `caps lock` æŒ‰é”®ï¼Œå¯æ”¹ä¸º `right shift` æŒ‰é”®

## ä¿®æ”¹é…ç½®

ä½ å¯ä»¥ç¼–è¾‘ `config.py` ï¼Œåœ¨å¼€å¤´éƒ¨åˆ†æœ‰æ³¨é‡Šï¼ŒæŒ‡å¯¼ä½ ä¿®æ”¹æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯çš„ï¼š

- è¿æ¥çš„åœ°å€å’Œç«¯å£ï¼Œé»˜è®¤æ˜¯ `127.0.0.1` å’Œ `6006` 
- é”®ç›˜å¿«æ·é”®
- æ˜¯å¦è¦ä¿å­˜å½•éŸ³æ–‡ä»¶
- è¦ç§»é™¤è¯†åˆ«ç»“æœæœ«å°¾çš„å“ªäº›æ ‡ç‚¹ï¼Œï¼ˆå¦‚æœä½ æƒ³æŠŠå¥å°¾çš„é—®å·ä¹Ÿåˆ é™¤æ‰ï¼Œå¯ä»¥åœ¨è¿™è¾¹åŠ ä¸Šï¼‰

![image-20240108114558762](assets/image-20240108114558762.png)  




## ä¸‹è½½æ¨¡å‹

æœåŠ¡ç«¯ä½¿ç”¨äº† [sherpa-onnx](https://k2-fsa.github.io/sherpa/onnx/index.html) ï¼Œè½½å…¥é˜¿é‡Œå·´å·´å¼€æºçš„ [Paraformer](https://www.modelscope.cn/models/damo/speech_paraformer-large-vad-punc_asr_nat-zh-cn-16k-common-vocab8404-pytorch) æ¨¡å‹ï¼ˆ[è½¬ä¸ºé‡åŒ–çš„onnxæ ¼å¼](https://k2-fsa.github.io/sherpa/onnx/pretrained_models/offline-paraformer/paraformer-models.html)ï¼‰ï¼Œæ¥ä½œè¯­éŸ³è¯†åˆ«ï¼Œæ•´ä¸ªæ¨¡å‹çº¦ 230MB å¤§å°ã€‚ä¸‹è½½æœ‰å·²è½¬æ¢å¥½çš„æ¨¡å‹æ–‡ä»¶ï¼š

- [csukuangfj/sherpa-onnx-paraformer-zh-2023-09-14](https://huggingface.co/csukuangfj/sherpa-onnx-paraformer-zh-2023-09-14) 

å¦å¤–ï¼Œè¿˜ä½¿ç”¨äº†é˜¿é‡Œå·´å·´çš„æ ‡ç‚¹ç¬¦å·æ¨¡å‹ï¼Œå¤§å°çº¦ 1GBï¼š

- [CT-Transformeræ ‡ç‚¹-ä¸­è‹±æ–‡-é€šç”¨-large-onnx](https://www.modelscope.cn/models/damo/punc_ct-transformer_cn-en-common-vocab471067-large-onnx/summary)

**æ¨¡å‹æ–‡ä»¶å¤ªå¤§ï¼Œå¹¶æ²¡æœ‰åŒ…å«åœ¨ GitHub åº“é‡Œé¢ï¼Œä½ å¯ä»¥ä»ç™¾åº¦ç½‘ç›˜æˆ–è€… GitHub Releases ç•Œé¢ä¸‹è½½å·²ç»è½¬æ¢å¥½çš„æ¨¡å‹æ–‡ä»¶ï¼Œè§£å‹åï¼Œå°† `models` æ–‡ä»¶å¤¹æ”¾åˆ°è½¯ä»¶æ ¹ç›®å½•** 

## è‡ªå¯åŠ¨ã€éšè—çª—å£ã€æ‹–ç›˜å›¾æ ‡ã€Docker

Windows éšè—é»‘çª—å£å¯åŠ¨ï¼Œè§ [\#49](https://github.com/HaujetZhao/CapsWriter-Offline/issues/49)ï¼Œå°†ä¸‹è¿°å†…å®¹ä¿å­˜ä¸º vbs è¿è¡Œï¼š

```
CreateObject("Wscript.Shell").Run "start_server.exe",0,True
CreateObject("Wscript.Shell").Run "start_client.exe",0,True
```

Windows è‡ªå¯åŠ¨ï¼Œæ–°å»ºå¿«æ·æ–¹å¼ï¼Œæ”¾åˆ° `shell:startup` ç›®å½•ä¸‹å³å¯ã€‚

å¸¦æ‹–ç›˜å›¾æ ‡çš„ GUI ç‰ˆï¼Œè§ [H1DDENADM1N/CapsWriter-Offline](https://github.com/H1DDENADM1N/CapsWriter-Offline/tree/GUI-(PySide6)-and-Portable-(PyStand)) 

Docker ç‰ˆï¼Œè§ [Garonix/CapsWriter-Offline at docker-support ](https://github.com/Garonix/CapsWriter-Offline/tree/docker-support) 


## æºç å®‰è£…ä¾èµ–

### \[New\] Linux ç«¯
```bash
# for core_server.py
pip install -r requirements-server.txt  -i https://mirror.sjtu.edu.cn/pypi/web/simple
# [NOTE]: kaldi-native-fbank==1.17(ä½¿ç”¨1.18åŠä»¥ä¸Šä¼šæŠ¥é”™`lib/python3.10/site-packages/_kaldi_native_fbank.cpython-310-x86_64-linux-gnu.so: undefined symbol: _ZN3knf24OnlineGenericBaseFeatureINS_22WhisperFeatureComputerEE13InputFinishedEv`)

# for core_client.py
pip install -r requirements-client.txt  -i https://mirror.sjtu.edu.cn/pypi/web/simple
sudo apt-get install xclip   # è®©core_client.pyæ­£å¸¸è¿è¡Œ
```
**è¿è¡Œæ–¹å¼**
`core_server.py`   # æ— éœ€ä»¥ root æƒé™è¿è¡Œ
`core_client.py`   # æ³¨æ„: å¿…é¡»ä»¥ root æƒé™è¿è¡Œ!!

### Windows ç«¯

```powershell
pip install -r requirements-server.txt
pip install -r requirements-client.txt
```

æœ‰äº›ä¾èµ–åœ¨ `Python 3.11` è¿˜æš‚æ—¶ä¸æ— æ³•å®‰è£…ï¼Œå»ºè®®ä½¿ç”¨ `Python 3.8 - Python3.10`  

### Mac ç«¯

åœ¨ Arm èŠ¯ç‰‡çš„ MacOS ç”µè„‘ä¸Šï¼ˆå¦‚ MacBook M1ï¼‰æ— æ³•ä½¿ç”¨ pip å®‰è£… `sherpa_onnx` ï¼Œéœ€è¦æ‰‹åŠ¨ä»æºä»£ç å®‰è£…ï¼š

```
git clone https://github.com/k2-fsa/sherpa-onnx
cd sherpa-onnx
python3 setup.py install
```

åœ¨ MacOS ä¸Šï¼Œå®‰è£… `funasr_onnx` ä¾èµ–çš„æ—¶å€™å¯èƒ½ä¼šæŠ¥é”™ï¼Œç¼ºå¤± `protobuf compiler`ï¼Œå¯ä»¥é€šè¿‡ `brew install protobuf` è§£å†³ã€‚

## æºç è¿è¡Œ

1. è¿è¡Œ `core_server.py` è„šæœ¬ï¼Œä¼šè½½å…¥ Paraformer æ¨¡å‹è¯†åˆ«æ¨¡å‹å’Œæ ‡ç‚¹æ¨¡å‹ï¼ˆè¿™ä¼šå ç”¨2GBçš„å†…å­˜ï¼Œè½½å…¥æ—¶é•¿çº¦ 50 ç§’ï¼‰
2. è¿è¡Œ `core_client.py` è„šæœ¬ï¼Œå®ƒä¼šæ‰“å¼€ç³»ç»Ÿé»˜è®¤éº¦å…‹é£ï¼Œå¼€å§‹ç›‘å¬æŒ‰é”®ï¼ˆ`MacOS` ç«¯éœ€è¦ `sudo`ï¼‰
3. æŒ‰ä½ `CapsLock` é”®ï¼Œå½•éŸ³å¼€å§‹ï¼Œæ¾å¼€ `CapsLock` é”®ï¼Œå½•éŸ³ç»“æŸï¼Œè¯†åˆ«ç»“æœç«‹é©¬è¢«è¾“å…¥ï¼ˆå½•éŸ³æ—¶é•¿çŸ­äº0.3ç§’ä¸ç®—ï¼‰

MacOS ç«¯æ³¨æ„äº‹é¡¹ï¼š

- MacOS ä¸Šç›‘å¬ `CapsLock` é”®å¯èƒ½ä¼šå‡ºé”™ï¼Œéœ€è¦å¿«æ·é”®ä¿®æ”¹ä¸ºå…¶ä»–æŒ‰é”®ï¼Œå¦‚ `right shift` 

## æ‰“åŒ…æ–¹æ³•
Windows/MacOS/Linuxå‡ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®Œæˆæ‰“åŒ…:
`pyinstaller build.spec`

## è¿è¡Œæ–¹å¼
### Linux 
åŒå‡» `run.sh` è‡ªåŠ¨è¾“å…¥sudoå¯†ç ä¸”å®ç°å·¦å³åˆ†å±å±•ç¤º
![](./assets/run-sh.png)





















